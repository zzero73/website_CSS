<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è‰²å½©è¨˜æ†¶å¤§è€ƒé©— - ç‹å¹¸ç¿çš„å¯æ„›ç‰ˆéŠæˆ² (Bootstrap)</title>
    <!-- å¼•å…¥ Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- å¼•å…¥ Google å­—é«” -->
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bs-body-bg: #fdf2f8;
            --main-pink: #db2777;
            --card-shadow: 0 15px 0px #f1f5f9;
        }

        body {
            font-family: 'Quicksand', sans-serif;
            background: linear-gradient(135deg, #fdf2f8 0%, #e0f2fe 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0;
        }

        /* åå­—èƒ¸ç«  */
        #author-tag {
            position: absolute;
            top: 20px;
            left: 20px;
            background: white;
            padding: 10px 20px;
            border-radius: 50px;
            box-shadow: 0 5px 0px #e2e8f0;
            border: 2px solid #fbcfe8;
            font-weight: 700;
            color: var(--main-pink);
            z-index: 1000;
        }

        /* éŠæˆ²ä¸»å®¹å™¨ */
        .game-card {
            border: 4px solid #bae6fd;
            border-radius: 40px;
            box-shadow: var(--card-shadow);
            max-width: 500px;
            width: 100%;
            background: white;
            padding: 40px 20px;
        }

        /* é›£åº¦åˆ‡æ›æŒ‰éˆ•è‡ªå®šç¾© */
        .btn-check:checked+.btn-outline-info {
            background-color: #3bc9db;
            color: white;
        }

        /* è‰²å¡Šç¶²æ ¼ */
        .color-grid {
            display: grid;
            gap: 15px;
            margin: 20px auto;
            max-width: 320px;
        }

        .grid-4 {
            grid-template-columns: repeat(2, 1fr);
        }

        .grid-9 {
            grid-template-columns: repeat(3, 1fr);
        }

        /* å¯æ„›è‰²å¡Š */
        .color-tile {
            aspect-ratio: 1 / 1;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            border: 5px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 6px 0px rgba(0, 0, 0, 0.05);
            user-select: none;
            opacity: 0.8;
        }

        .color-tile:hover {
            transform: scale(1.03) rotate(2deg);
            opacity: 1;
        }

        /* é–ƒçˆæ•ˆæœ */
        .active-flash {
            transform: scale(1.1) rotate(-3deg) !important;
            box-shadow: 0 0 25px currentColor !important;
            border-color: white !important;
            opacity: 1 !important;
        }

        /* åˆ†æ•¸å€åŸŸ */
        .score-panel {
            background-color: #fff9db;
            border: 2px dashed #fab005;
            border-radius: 20px;
        }

        /* é–‹å§‹æŒ‰éˆ• */
        .btn-game-start {
            background-color: #ff8787;
            border: none;
            border-radius: 50px;
            padding: 12px 40px;
            font-size: 1.5rem;
            font-weight: 700;
            color: white;
            box-shadow: 0 6px 0 #fa5252;
            transition: all 0.1s;
        }

        .btn-game-start:hover {
            background-color: #ff6b6b;
            transform: translateY(2px);
            box-shadow: 0 4px 0 #fa5252;
        }

        .btn-game-start:active {
            transform: translateY(6px);
            box-shadow: 0 0px 0 #fa5252;
        }

        #message-box {
            font-size: 1.1rem;
            font-weight: 700;
            color: #495057;
            min-height: 1.5em;
        }
    </style>
</head>

<body>

    <!-- åå­—æ¨™ç±¤ -->
    <div id="author-tag">
        ğŸ¾ è¨­è¨ˆè€…ï¼š<span id="name-display">è¼‰å…¥ä¸­...</span>
    </div>

    <div class="container d-flex justify-content-center">
        <div class="game-card text-center">
            <h1 class="display-5 fw-bold text-info mb-1">âœ¨ è‰²å½©å°ç²¾éˆ âœ¨</h1>
            <p class="text-secondary fw-bold mb-4">è·Ÿè‘—å‹•ç‰©å¤¥ä¼´ä¸€èµ·ç©è¨˜æ†¶éŠæˆ²ï¼</p>

            <!-- é›£åº¦é¸æ“‡ (Bootstrap Button Group) -->
            <div class="btn-group mb-4" role="group">
                <input type="radio" class="btn-check" name="difficulty" id="diff4" checked onclick="setDifficulty(4)">
                <label class="btn btn-outline-info px-4 rounded-start-pill" for="diff4">ğŸ° ç°¡å–®</label>

                <input type="radio" class="btn-check" name="difficulty" id="diff9" onclick="setDifficulty(9)">
                <label class="btn btn-outline-info px-4 rounded-end-pill" for="diff9">ğŸ¦ æŒ‘æˆ°</label>
            </div>

            <!-- åˆ†æ•¸é¢æ¿ -->
            <div class="score-panel p-3 mb-4 d-flex justify-content-around">
                <div class="h5 m-0 text-dark">â­ åˆ†æ•¸: <span id="score" class="text-primary">0</span></div>
                <div class="h5 m-0 text-dark">ğŸ† æœ€é«˜: <span id="high-score" class="text-danger">0</span></div>
            </div>

            <div id="message-box" class="mb-3">æº–å‚™å¥½å°±æŒ‰é–‹å§‹å§ï¼</div>

            <!-- éŠæˆ²ç¶²æ ¼ -->
            <div id="game-grid" class="color-grid grid-4 mb-4">
                <!-- å‹•æ…‹ç”Ÿæˆ -->
            </div>

            <button id="start-btn" class="btn-game-start" onclick="startGame()">éŠæˆ²é–‹å§‹ï¼</button>
        </div>
    </div>

    <!-- å¼•å…¥ Bootstrap Bundle JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        const MY_NAME = "ç‹å¹¸ç¿";
        document.getElementById('name-display').innerText = MY_NAME;

        const TILE_DATA = [
            { color: '#ffadad', icon: 'ğŸ' },
            { color: '#ffd6a5', icon: 'ğŸ¦Š' },
            { color: '#fdffb6', icon: 'ğŸ¥' },
            { color: '#caffbf', icon: 'ğŸ¢' },
            { color: '#9bf6ff', icon: 'ğŸ³' },
            { color: '#a0c4ff', icon: 'ğŸ˜' },
            { color: '#bdb2ff', icon: 'ğŸ¦„' },
            { color: '#ffc6ff', icon: 'ğŸ·' },
            { color: '#fffffc', icon: 'ğŸ¼' }
        ];

        let gameSequence = [];
        let playerSequence = [];
        let score = 0;
        let highScore = 0;
        let isPlaying = false;
        let canClick = false;
        let difficulty = 4;

        const gridElement = document.getElementById('game-grid');
        const scoreElement = document.getElementById('score');
        const highScoreElement = document.getElementById('high-score');
        const messageBox = document.getElementById('message-box');
        const startBtn = document.getElementById('start-btn');

        function initGrid() {
            gridElement.innerHTML = '';
            gridElement.className = `color-grid grid-${difficulty}`;

            for (let i = 0; i < difficulty; i++) {
                const tile = document.createElement('div');
                tile.className = 'color-tile';
                tile.style.backgroundColor = TILE_DATA[i].color;
                tile.style.color = TILE_DATA[i].color;
                tile.innerHTML = `<span>${TILE_DATA[i].icon}</span>`;
                tile.onclick = () => handleTileClick(i);
                gridElement.appendChild(tile);
            }
        }

        // ä¿®æ”¹ï¼šå…è¨±éš¨æ™‚åˆ‡æ›é›£åº¦ä¸¦é‡ç½®éŠæˆ²
        function setDifficulty(num) {
            difficulty = num;
            isPlaying = false; // å¼·åˆ¶çµæŸç•¶å‰ç‹€æ…‹
            canClick = false;
            initGrid();
            resetGame();
            startBtn.innerText = "éŠæˆ²é–‹å§‹ï¼";
        }

        function resetGame() {
            gameSequence = [];
            playerSequence = [];
            score = 0;
            scoreElement.innerText = score;
            messageBox.innerHTML = "é›£åº¦å·²åˆ‡æ›ï¼ŒæŒ‰é–‹å§‹æŒ‘æˆ°å§ï¼";
            startBtn.disabled = false;
            gridElement.style.pointerEvents = 'auto';
        }

        function startGame() {
            resetGame();
            isPlaying = true;
            startBtn.disabled = true;
            nextRound();
        }

        function nextRound() {
            playerSequence = [];
            canClick = false;
            gridElement.style.pointerEvents = 'none';

            // æ¯ä¸€å›åˆç”Ÿæˆå…¨æ–°åºåˆ—
            gameSequence = [];
            const sequenceLength = score + 1;
            for (let i = 0; i < sequenceLength; i++) {
                gameSequence.push(Math.floor(Math.random() * difficulty));
            }

            messageBox.innerHTML = `ğŸŒˆ è§€å¯Ÿå°å¤¥ä¼´è·³èˆ... (${sequenceLength}æ¬¡)`;
            playSequence();
        }

        async function playSequence() {
            await new Promise(r => setTimeout(r, 800));
            // å¦‚æœåœ¨æ’­æ”¾æœŸé–“åˆ‡æ›é›£åº¦ï¼Œå‰‡åœæ­¢æ’­æ”¾
            const currentRoundDiff = difficulty;

            for (let i = 0; i < gameSequence.length; i++) {
                if (!isPlaying || difficulty !== currentRoundDiff) return;
                await flashTile(gameSequence[i]);
                await new Promise(r => setTimeout(r, 300));
            }

            if (!isPlaying || difficulty !== currentRoundDiff) return;
            canClick = true;
            gridElement.style.pointerEvents = 'auto';
            messageBox.innerHTML = "ğŸ™Œ æ›ä½ è©¦è©¦çœ‹å›‰ï¼";
        }

        function flashTile(index) {
            return new Promise(resolve => {
                const tiles = document.getElementsByClassName('color-tile');
                const tile = tiles[index];
                if (tile) {
                    tile.classList.add('active-flash');
                    setTimeout(() => {
                        tile.classList.remove('active-flash');
                        resolve();
                    }, 500);
                } else {
                    resolve();
                }
            });
        }

        function handleTileClick(index) {
            if (!canClick || !isPlaying) return;

            const tiles = document.getElementsByClassName('color-tile');
            tiles[index].classList.add('active-flash');
            setTimeout(() => tiles[index].classList.remove('active-flash'), 200);

            const currentStep = playerSequence.length;
            if (index === gameSequence[currentStep]) {
                playerSequence.push(index);
                if (playerSequence.length === gameSequence.length) {
                    score++;
                    scoreElement.innerText = score;
                    if (score > highScore) {
                        highScore = score;
                        highScoreElement.innerText = highScore;
                    }
                    canClick = false;
                    gridElement.style.pointerEvents = 'none';
                    messageBox.innerHTML = "<span class='text-success'>ğŸ‰ å¤ªå²å®³äº†ï¼ä¸‹ä¸€é—œï¼</span>";
                    setTimeout(nextRound, 1200);
                }
            } else {
                gameOver();
            }
        }

        function gameOver() {
            isPlaying = false;
            canClick = false;
            gridElement.style.pointerEvents = 'none';
            messageBox.innerHTML = `<span class="text-danger">å“å‘€ï¼åˆ†æ•¸æ˜¯ ${score}ï¼Œå†ç©ä¸€æ¬¡å§ï¼</span>`;
            startBtn.innerText = "é‡æ–°é–‹å§‹å†’éšª";
            startBtn.disabled = false;
        }

        window.onload = initGrid;
    </script>
</body>

</html>